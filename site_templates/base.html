<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Local Business Directory{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}Discover local businesses in your area. Professional services, restaurants, automotive, and more.{% endblock %}">
    {% block meta_keywords %}{% endblock %}

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}{{ request.url if request else '' }}{% endblock %}">
    <meta property="og:title" content="{% block og_title %}{{ self.title() }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.meta_description() }}{% endblock %}">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="{% block twitter_url %}{{ self.og_url() }}{% endblock %}">
    <meta property="twitter:title" content="{% block twitter_title %}{{ self.og_title() }}{% endblock %}">
    <meta property="twitter:description" content="{% block twitter_description %}{{ self.og_description() }}{% endblock %}">

    <!-- Canonical URL -->
    {% block canonical %}{% endblock %}

    <!-- Stylesheets -->
    <link rel="stylesheet" href="{% block css_path %}../styles.css{% endblock %}">
    {% block extra_css %}{% endblock %}

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <!-- Structured Data -->
    {% block structured_data %}{% endblock %}

    <!-- Analytics -->
    {% block analytics %}
    <script async>
        // Basic analytics tracking
        (function() {
            if (typeof gtag !== 'undefined') {
                gtag('config', 'GA_TRACKING_ID');
            }
        })();
    </script>
    {% endblock %}
</head>
<body class="{% block body_class %}{% endblock %}">
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    {% block header %}
    <header class="site-header">
        <div class="container">
            <nav class="main-navigation" role="navigation" aria-label="Main navigation">
                <div class="nav-brand">
                    <a href="{% block home_url %}/{% endblock %}" class="logo">
                        <span class="logo-text">Local Business Directory</span>
                    </a>
                </div>
                <div class="nav-menu">
                    <ul class="nav-list">
                        <li class="nav-item"><a href="{% block home_url %}/{% endblock %}" class="nav-link">Home</a></li>
                        <li class="nav-item"><a href="{% block home_url %}/{% endblock %}#search" class="nav-link">Search</a></li>
                        <li class="nav-item"><a href="{% block home_url %}/{% endblock %}#categories" class="nav-link">Categories</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>
    {% endblock %}

    {% block breadcrumbs %}{% endblock %}

    <main id="main-content" class="main-content" role="main">
        <div class="container">
            {% block content %}
            <h1>Welcome to Local Business Directory</h1>
            <p>Find local businesses in your area.</p>
            {% endblock %}
        </div>
    </main>

    {% block sidebar %}{% endblock %}

    {% block footer %}
    <footer class="site-footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Local Business Directory</h3>
                    <p>Connecting you with quality local businesses in your community.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="{% block home_url %}/{% endblock %}">Home</a></li>
                        <li><a href="{% block home_url %}/{% endblock %}sitemap.xml">Sitemap</a></li>
                        <li><a href="{% block home_url %}/{% endblock %}robots.txt">Robots</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>About</h4>
                    <p>Generated by the Agentic Local SEO Content Factory</p>
                    <p>Powered by AWS and Amazon Bedrock</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; {% block copyright_year %}{{ moment().year if moment else '2024' }}{% endblock %} Local Business Directory.
                Generated on {% block generation_date %}{{ moment().format('MMMM DD, YYYY') if moment else 'Unknown' }}{% endblock %}.</p>
                <p class="tech-credit">Built with Python, AWS Lambda, and Amazon Bedrock AI</p>
            </div>
        </div>
    </footer>
    {% endblock %}

    <!-- JavaScript -->
    {% block javascript %}
    <script>
        // Basic interactivity
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                });
            }

            // Smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // Basic SEO tracking
            if (window.gtag) {
                gtag('event', 'page_view', {
                    page_title: document.title,
                    page_location: window.location.href
                });
            }
        });
    </script>
    {% endblock %}

    {% block extra_javascript %}{% endblock %}

    <!-- Load analytics script -->
    <script src="/analytics.js" async></script>
</body>
</html>